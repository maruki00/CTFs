# johnlions

The machine is running unixv7, which means that it should be full of
bugs. We notice several bugs, including a buffer overflow in rmdir, but
we ended up abusing /bin/mail to read arbitrary files.

/bin/mail is setuid root. It uses a temporary file, which it reopens
several times, to hold a new mail's contents. We can read the flag file
by sending ourselves mail and replacing the temporary file with a link
to /flag while mail is waiting on our input.

To do this, we used a small C program (mail_exp.c) which sends the mail
in the background (with a sleep before writing the message so that we
replace the temporary file).

Running this program and checking our mail gives the flag.
